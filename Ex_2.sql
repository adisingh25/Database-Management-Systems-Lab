CREATE DATABASE DBMS_LAB;
SHOW DATABASES;
USE DBMS_LAB;

SHOW TABLES;

CREATE TABLE PART(
	PNO INT,
    PNAME VARCHAR(10),
    COLOUR VARCHAR(10),
    PRIMARY KEY (PNO)
    );
    
INSERT INTO PART VALUES(
	101, 'BOLTS', 'BLUE'),
    (102, 'NUTS', 'RED'),
    (103, 'PLUGS', 'BLUE'),
    (105, 'BOLTS', 'RED'),
    (106, 'NUTS', 'BLUE'),
    (107, 'PLUGS', 'RED'),
    (108, 'BOLTS', 'GREEN'),
    (109, 'NUTS', 'GREEN'),
    (110, 'PLUGS', 'GREEN');
    
SELECT * FROM PART;

CREATE TABLE SUPPLIER(
	SNO INT,
    SNAME VARCHAR(10),
    ADDRESS VARCHAR(10),
    PRIMARY KEY (SNO)
    );
    
INSERT INTO SUPPLIER VALUES
	(1, 'JASON', 'DELHI'),
    (2, 'PHLIP', 'MUMBAI'),
    (3, 'DALE', 'BENGALURU'),
    (4, 'JACOB', 'KOLKATA'),
    (5, 'JOS', 'CHENNAI');
    
SELECT * FROM SUPPLIER;


CREATE TABLE SUPPLY(
	PNO INT,
    SNO INT,
    QUANTITY INT,
    PRIMARY KEY (PNO,SNO),
    FOREIGN KEY (PNO) REFERENCES PART(PNO) ON DELETE CASCADE,
    FOREIGN KEY (SNO) REFERENCES SUPPLIER(SNO) ON DELETE CASCADE
    );
   

INSERT INTO SUPPLY VALUES
	(101, 1, 10);
INSERT INTO SUPPLY VALUES
    (102, 3, 20),
    (103, 4, 5),
    (105, 5, 4),
    (106, 1, 25),
    (107, 2, 14),
    (108, 3, 12),
    (109, 4, 10),
    (110, 5, 30),
    (101, 3, 15),
    (102, 5, 4),
    (103, 5, 18);

SELECT * FROM SUPPLY;


SELECT * FROM PART WHERE PNO IN(SELECT PNO FROM SUPPLY WHERE SNO IN(SELECT SNO FROM SUPPLIER WHERE SNAME='JASON'));
SELECT SNAME FROM SUPPLIER WHERE SNO IN(SELECT SNO FROM SUPPLY WHERE PNO IN(SELECT PNO FROM PART WHERE PNAME='BOLTS'));
DELETE FROM PART WHERE COLOUR LIKE 'GREEN';

SET SQL_SAFE_UPDATES=1;

SELECT * FROM PART;

SELECT SNO,SNAME FROM SUPPLIER WHERE SNO IN (
	SELECT SNO
    FROM SUPPLY
    GROUP BY SNO
    HAVING COUNT(*) = 2);



    